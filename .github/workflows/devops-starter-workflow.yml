name: Build and Deploy Python app to Azure
on:
  push:
    branches:
      - master

env:
  AZURE_WEBAPP_NAME: "final-project-D0928898"    # set this to your application's name
  AZURE_WEBAPP_PACKAGE_PATH: "Application"      # set this to the path to your web app project, defaults to the repository root
  PYTHON_VERSION: '3.7.5'                       # set this to the python version to use
  RESOURCEGROUPNAME: "final-project-D0928898-rg"
  LOCATION: "South Central US"
  HOSTINGPLANNAME: "final-project-D0928898-plan"
  APPINSIGHTLOCATION: "South Central US"
  SKU: "S1 Standard"

sunny
#1986
nodding

瑪琳&胡桃的鬼鬼 — 2022/12/25 03:02
話說
編譯器是這禮拜還下禮拜?
KIYO — 2022/12/25 03:08
12/26
明天
瑪琳&胡桃的鬼鬼 — 2022/12/25 03:08
:puppysad:
下禮拜發考卷還是直接走人?
KIYO — 2022/12/25 03:15
你問的是期末考嗎?
瑪琳&胡桃的鬼鬼 — 2022/12/25 03:16
4
KIYO — 2022/12/25 03:16
那就是1/2
瑪琳&胡桃的鬼鬼 — 2022/12/25 03:16
:AYAYAYA:
KIYO — 2022/12/25 03:16
下禮拜二三晚上是要DEMO
瑪琳&胡桃的鬼鬼 — 2022/12/25 03:16
OK:SIBALAOMA:
KIYO — 2022/12/25 03:17
下禮拜二照理會洩題 聽一下課不虧
FBK — 昨天 09:09
@ewd9210 可不可以借clone你的Azure Devops，我的一直瘋狂報錯
FBK — 昨天 09:55
網頁內容當然會換一個做啦
ewd9210 — 昨天 13:07
我教你 你拿當初最早做bmi或是搜索列的那個改
改他的index.html就好
FBK — 昨天 13:09
就是那個爛掉了
先報python 3.6
再報werkzeug
修不好
ewd9210 — 昨天 13:11
我是用軟體測試的那個做的
FBK — 昨天 13:12
完了，他一直吃超多錢我刪掉了
ewd9210 — 昨天 13:12
你照軟體測試的方法開一個空的devops starts
然後去yml那邊把job底下通通換成這個
jobs:
  Build:
    name: Build and Run tests
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - uses: actions/setup-python@v4
      with:
        python-version: '3.8'

    - name: Install Dependancies
      continue-on-error: false
      run: |
        pip install -r Application/requirements.txt
  
   # - name: Pytest
   #   continue-on-error: false
   #   run: |
   #     mkdir testresults
   #     pip install pytest
   #     pip install pytest-cov
   #     pytest --cov=./ --cov-config=.coveragerc --cov-report term-missing Tests/unit_tests --junitxml=./testresults/test-results.xml
   #     pip install pycmd
   #     py.cleanup Tests/
   
   # - uses: actions/checkout@v2
   #   with:
   #     fetch-depth: 0
   # - uses: sonarsource/sonarqube-scan-action@master
   #   env:
   #     SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
        
    # Uploading unit test results to artifact store
    - name: Upload unit test results to Artifact
      continue-on-error: false
      uses: actions/upload-artifact@v2
      with:
        name: UnitTestResults
        path: ./testresults/test-results.xml

    - name: Building web app
      uses: azure/appservice-build@v2-beta
      with:
          source-directory: ${{ env.AZURE_WEBAPP_PACKAGE_PATH }}
          output-directory: ${{ env.AZURE_WEBAPP_PACKAGE_PATH }}

    - name: Creating artifact directories
      run: |
        mkdir buildartifacts
        mkdir testartifacts
        mkdir deploymenttemplates
    # Archive build artifact
    - name: Archive Application
      run: |
       zip -qq -r ./buildartifacts/Application.zip ./Application
    # Uploading application to artifact store
    - name: Upload Application to Build Artifact
      continue-on-error: false
      uses: actions/upload-artifact@v2
      with:
        name: buildartifacts
        path: buildartifacts

    # Archive Arm template
    - name: Archive ArmTemplates
      run: |
        zip -qq -r ./deploymenttemplates/ArmTemplates.zip ./ArmTemplates
    # Uploading Arm Template to artifact store
    - name: Upload Arm templates to Artifact
      continue-on-error: false
      uses: actions/upload-artifact@v2
      with:
        name: deploymenttemplates
        path: deploymenttemplates

  Deploy:
    name: Deploy to azure web app
    needs: Build
    runs-on: ubuntu-latest
    steps:
    # Downloading build artifact
    - name: Download Build Artifact
      uses: actions/download-artifact@v2
      continue-on-error: false
      with:
        name: buildartifacts
        path: buildartifacts

    # Unzipping build artifacts
    - name: Unzipping Build Artifact
      run: |
        unzip -qq ./buildartifacts/Application.zip -d .
  # Downloading Arm Template
    - name: Download Arm Template
      uses: actions/download-artifact@v2
      continue-on-error: false
      with:
        name: deploymenttemplates
        path: deploymenttemplates

... (還剩 25 行)
收起
3.txt
5 KB
FBK — 昨天 13:13
K
ewd9210 — 昨天 13:14
這個是沒有sonar pytest function test的 我拿掉了
然後他的imdex.html我記得在application app template 那邊
改index就好 其他不要亂刪
FBK — 昨天 13:16
真的有夠想用react自己搞，但我沒伺服器能架網站
阿薩斯龍語-真的好強 — 昨天 14:21
:NootNoot:
Felix007 — 昨天 14:32
軟體測試要用azure哦:puppysad:
FBK — 昨天 14:34
?
Felix007 — 昨天 14:42
不然為啥用azure:worrySad:
我的也是弄不好
幻玄櫻|米蘇推し — 昨天 14:47
？
ewd9210 — 昨天 14:52
:Thonk_1:
瑪琳&胡桃的鬼鬼 — 昨天 15:04
:ganyustare:
Felix007 — 昨天 15:06
所以不用就是了
幻玄櫻|米蘇推し — 昨天 15:06
？
瑪琳&胡桃的鬼鬼 — 昨天 15:08
圖片
猫島たま|わからない — 昨天 15:18
不然你要aws嗎
Felix007 — 昨天 15:19
我指考試:AobaREEE: 漏了
可以都不要嗎:Sudoku:
不用雲
FBK — 昨天 15:27
到底公三小
煩死了
Felix007 — 昨天 16:17
就是"考試要用azure做devops嗎？"
猫島たま|わからない — 昨天 16:18
:puppysad:
不然你要用aws做嗎
Felix007 — 昨天 16:20
:filianRip:
瑪琳&胡桃的鬼鬼 — 昨天 16:21
:Karyl_04:
我不知道
從一開始對話就不在一個頻道上
這還講啥
Felix007 — 昨天 16:24
所以devops要考哦:filianRip:
Maple — 昨天 16:45
:KyouryuuWaaat:
Maple — 昨天 16:46
都考都看 Aws azure一起讀就沒問題了
Felix007 — 昨天 16:47
不要被女裝人士騙了
aws沒有教
幻玄櫻|米蘇推し — 昨天 16:48
這東西上了三個還四個禮拜 你說呢
Felix007 — 昨天 16:49
:worrySad:
FBK — 昨天 17:14
幹
圖片
FBK — 昨天 17:23
嗯?
幻玄櫻|米蘇推し — 昨天 17:23
嗯！
FBK — 昨天 17:23
喔
就是這頁
瑪琳&胡桃的鬼鬼 — 昨天 17:25
喔？
FBK — 昨天 17:49
每次都要重跑5分鐘，躁到不行
猫島たま|わからない — 昨天 17:51
我想要直接翹掉資安回去做明機的垃圾azure
:think:
FBK — 昨天 17:54
政堃大人已經降下神諭了
照做就對了，不會報錯，報錯就是你醜
猫島たま|わからない — 昨天 17:56
可
瑪琳&胡桃的鬼鬼 — 昨天 17:58
圖片
前端就好？
FBK — 昨天 18:02
前端就好
我甚至不打算動css
瑪琳&胡桃的鬼鬼 — 昨天 18:03
100%html？
FBK — 昨天 18:03
y
心得比較麻煩
猫島たま|わからない — 昨天 18:04
@FBK 我好想那你之前寫的html
:catOMEGALUL:
FBK — 昨天 18:05
你要去圖書館薦購系統抓一個東西貼到你的網站上欸
建議去別人的網站抓比較快
猫島たま|わからない — 昨天 18:06
:think:
ewd9210 — 昨天 19:27
我這頁弄出來以後 就直接用notepad++寫ㄌ
圖片
我只寫這ㄍ
FBK — 昨天 19:29
嗯，直接改掉就不管了
你還有調顏色:AobaREEE:
ewd9210 — 昨天 19:31
對 我是幹學校下來 刪掉多餘的再改顏色
不過我有做sonarqube
如果你之前軟體測試有做出sonarqube 這次就簡單了
FBK — 昨天 19:32
上次有，但刪掉了🚮
幻玄櫻|米蘇推し — 昨天 19:32
:meow:
ewd9210 — 昨天 19:32
👀
FBK — 昨天 19:32
:Thonk_1:
怎，還是我記錯
ewd9210 — 昨天 19:36
刪掉的話建議你別做sonarqubeㄌ 那超麻煩的
反正也不是必要
FBK — 昨天 19:37
看了一下，的確不必要，很多人都說用人工測試而已
ewd9210 — 昨天 19:59
我剛剛也看了一下 我吃快700ㄌ 我也刪掉之前的了
我相信軟體測試不會考那東西的
sonarqube關掉也會耗錢 有夠靠北的
幻玄櫻|米蘇推し — 昨天 20:02
給他耗
:KABO:
ewd9210 — 昨天 20:03
好險我軟體工程已經截圖完了 趕緊刪掉
瑪琳&胡桃的鬼鬼 — 昨天 20:08
圖片
所以差不多這樣是ok的?
ewd9210 — 昨天 20:12
應該吧
最鳥的就做公佈欄
瑪琳&胡桃的鬼鬼 — 昨天 20:13
圖片
我去看別人做的
ewd9210 — 昨天 20:13
好認真
瑪琳&胡桃的鬼鬼 — 昨天 20:13
可是我去逢甲圖書館上都沒看到甚麼nid
不知道他們那些怎麼來的
瑪琳&胡桃的鬼鬼 — 昨天 20:57
圖片
記得之前好像也有過
但是忘了怎麼解決的
布魯艾斯懷特多拉貢 — 昨天 22:05
超隨便的完成筆記
猫島たま|わからない — 昨天 22:58
幹我想找人的來clone :AobaREEE:
猫島たま|わからない — 昨天 23:28
幹azure只有單一網站嗎?
我有沒有辦法像是
xxx.azurewebsites.net/en/
xxx.azurewebsites.net/jp/
之類的
幹 不行
好吧 @布魯艾斯懷特多拉貢 我要來修你的code了
:catOMEGALUL:
等等
我不會js
:fillyRIP:
幻玄櫻|米蘇推し — 昨天 23:35
:Black_Cat:
ewd9210 — 昨天 23:36
圖片
可以啊 像我多的就沒刪掉
猫島たま|わからない — 昨天 23:38
:nkoAhh:
你的底是用甚麼 
我用BMI的底來做的
ewd9210 — 昨天 23:39
我用github action
最簡單的就多寫一個en.html
然後把中文的翻成英文照抄過去
選擇語言的時候就切換到en.html就好
猫島たま|わからない — 昨天 23:41
我現在就是這麼想但是我不知道要怎麼讓我打/en的時候連到en.html
ewd9210 — 昨天 23:44
圖片
django是這樣 其他我不知道
猫島たま|わからない — 昨天 23:46
早就知道直接拿之前的django直接趴上去就好
:AobaREEE:
布魯艾斯懷特多拉貢 — 今天 00:02
:WatameConfused:
FBK — 今天 00:16
好，搞定了，破爛網頁，但會動
css ?
沒有那種東西，全都塞進html裡
猫島たま|わからない — 今天 00:18
很好
圖片
我完全不會
他Select不會動
FBK — 今天 00:21
你可以考慮整坨換成i18n
猫島たま|わからない — 今天 00:38
:nkoAhh:
what
﻿
jobs:
  Build:
    name: Build and Run tests
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - uses: actions/setup-python@v4
      with:
        python-version: '3.8'

    - name: Install Dependancies
      continue-on-error: false
      run: |
        pip install -r Application/requirements.txt
  
   # - name: Pytest
   #   continue-on-error: false
   #   run: |
   #     mkdir testresults
   #     pip install pytest
   #     pip install pytest-cov
   #     pytest --cov=./ --cov-config=.coveragerc --cov-report term-missing Tests/unit_tests --junitxml=./testresults/test-results.xml
   #     pip install pycmd
   #     py.cleanup Tests/
   
   # - uses: actions/checkout@v2
   #   with:
   #     fetch-depth: 0
   # - uses: sonarsource/sonarqube-scan-action@master
   #   env:
   #     SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
        
    # Uploading unit test results to artifact store
    - name: Upload unit test results to Artifact
      continue-on-error: false
      uses: actions/upload-artifact@v2
      with:
        name: UnitTestResults
        path: ./testresults/test-results.xml

    - name: Building web app
      uses: azure/appservice-build@v2-beta
      with:
          source-directory: ${{ env.AZURE_WEBAPP_PACKAGE_PATH }}
          output-directory: ${{ env.AZURE_WEBAPP_PACKAGE_PATH }}

    - name: Creating artifact directories
      run: |
        mkdir buildartifacts
        mkdir testartifacts
        mkdir deploymenttemplates
    # Archive build artifact
    - name: Archive Application
      run: |
       zip -qq -r ./buildartifacts/Application.zip ./Application
    # Uploading application to artifact store
    - name: Upload Application to Build Artifact
      continue-on-error: false
      uses: actions/upload-artifact@v2
      with:
        name: buildartifacts
        path: buildartifacts

    # Archive Arm template
    - name: Archive ArmTemplates
      run: |
        zip -qq -r ./deploymenttemplates/ArmTemplates.zip ./ArmTemplates
    # Uploading Arm Template to artifact store
    - name: Upload Arm templates to Artifact
      continue-on-error: false
      uses: actions/upload-artifact@v2
      with:
        name: deploymenttemplates
        path: deploymenttemplates

  Deploy:
    name: Deploy to azure web app
    needs: Build
    runs-on: ubuntu-latest
    steps:
    # Downloading build artifact
    - name: Download Build Artifact
      uses: actions/download-artifact@v2
      continue-on-error: false
      with:
        name: buildartifacts
        path: buildartifacts

    # Unzipping build artifacts
    - name: Unzipping Build Artifact
      run: |
        unzip -qq ./buildartifacts/Application.zip -d .
  # Downloading Arm Template
    - name: Download Arm Template
      uses: actions/download-artifact@v2
      continue-on-error: false
      with:
        name: deploymenttemplates
        path: deploymenttemplates

    # Unzipping Arm Template directory
    - name: Unzipping ARM template
      run: |
       unzip -qq ./deploymenttemplates/ArmTemplates.zip -d .
    # Azure Login
    - name: Azure Login
      uses: azure/login@v1
      continue-on-error: false
      with:
        creds: ${{ secrets.AZURE_CREDENTIALS }}

    # Deploy ARM Template
    - name: Deploy ARM Template
      uses: azure/CLI@v1
      continue-on-error: false
      with:
        inlineScript: |
          az group create --name "${{ env.RESOURCEGROUPNAME }}" --location "${{ env.LOCATION }}"
          az deployment group create --resource-group "${{ env.RESOURCEGROUPNAME }}" --template-file ./ArmTemplates/linux-python-webapp-template.json --parameters webAppName="${{ env.AZURE_WEBAPP_NAME }}" hostingPlanName="${{ env.HOSTINGPLANNAME }}" appInsightsLocation="${{ env.APPINSIGHTLOCATION }}" sku="${{ env.SKU }}"
    # Deploy web app
    - name: 'Deploy to Azure WebApp'
      uses: azure/webapps-deploy@v2
      with: 
        app-name: ${{ env.AZURE_WEBAPP_NAME }}
        package: ${{ env.AZURE_WEBAPP_PACKAGE_PATH }}